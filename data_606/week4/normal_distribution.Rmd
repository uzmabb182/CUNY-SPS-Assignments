---
title: "The Normal Distribution - Week 4"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


# load the packages
```{r}
library(tidyverse)
library(openintro)

```


```{r}

data("fastfood", package='openintro')
head(fastfood)

```
# Filter the fastfood for values "Mcdonalds" and "Dairy Queen"
```{r}
mcdonalds <- fastfood %>%
  filter(restaurant == "Mcdonalds")

mcdonalds
```


```{r}
dairy_queen <- fastfood %>%
  filter(restaurant == "Dairy Queen")

dairy_queen
```

# Exercise 1: Make a plot (or plots) to visualize the distributions of the amount of calories from fat of the options 
# from these two restaurants. How do their centers, shapes, and spreads compare?

# Both the distributions are right skewed in the frequency histogram. There is a sudden drop in the distribution McDonalds fat calories data.
```{r}
mcdonalds %>%
  ggplot() +
  geom_histogram(aes(x = cal_fat), bins = 5) +
  ggtitle("Distribution of McDonalds Fat Calories") +
  xlab("Calories from Fat") +
  ylab("Frequency")
```

```{r}
dairy_queen %>%
  ggplot() +
  geom_histogram(aes(x = cal_fat), bins = 5) +
  ggtitle("Distribution of Dairy Queen Fat Calories") +
  xlab("Calories from Fat") +
  ylab("Frequency")
```
# Calculating the summary
```{r}
summary(mcdonalds$cal_fat)
hist(mcdonalds$cal_fat)
```

```{r}
summary(dairy_queen$cal_fat)
hist(dairy_queen$cal_fat)
```

# Calculating the mean and standard deviation
```{r}
dairy_queen_mean <- mean(dairy_queen$cal_fat)
dairy_queen_mean

```


```{r}

dairy_queen_sd   <- sd(dairy_queen$cal_fat)
dairy_queen_sd

```

# Now creating the density histogram
```{r}
ggplot(data = dairy_queen, aes(x = cal_fat)) +
        geom_blank() +
        geom_histogram(aes(y = ..density..)) +
        stat_function(fun = dnorm, args = c(mean = dairy_queen_mean, sd = dairy_queen_sd), col = "tomato")

```
Exercise 2: Based on the this plot, does it appear that the data follow a nearly normal distribution?

# One way to find if the data is normally distributed is by looking at the shape of the histogram.
# Another way is to constructing a normal probability plot, also called a normal Q-Q plot for “quantile-quantile”.

```{r}
ggplot(data = mcdonalds, aes(sample = cal_fat)) + 
  geom_line(stat = "qq")

```
# simulating data from a normal distribution using rnorm.

```{r}
sim_norm <- rnorm(n = nrow(dairy_queen), mean = dairy_queen_mean, sd = dairy_queen_sd)

sim_norm
```
# Exercise 3: Make a normal probability plot of sim_norm. Do all of the points fall on the line? How does this plot compare # to the probability plot for the real data? (Since sim_norm is not a data frame, it can be put directly into the sample 
# argument and the data argument can be dropped.)

```{r}

qqnormsim(sample = cal_fat, data = dairy_queen)

```
# Exercise 4: Does the normal probability plot for the calories from fat look similar to the plots created for the simulated data? That is, do the plots provide evidence that the calories are nearly normal?
```{r}
# The Dairy Queen cal_fat data (plotted below) is nearly normal. It closely follows a diagonal line and is incredibly 
# similar to the plots generated by qqnormsim (ie. sim 7).

```

# Exercise 5: Using the same technique, determine whether or not the calories from McDonald’s menu appear 
# to come from a normal distribution.

The Dairy Queen cal_fat data (plotted below) is nearly normal. Although the slope is rather small near the beginning and rather larger later on, it does form a diagonal line and closely similar to a couple of the simulated plots up until these higher values (ie. sim 1 or 3).

```{r}
qqnormsim(sample = cal_fat, data = mcdonalds)

```
# Normal Probabilities:

# we can find this probability by calculating a Z score and consulting a Z table (also called a normal probability table). 
# In R, this is done in one step with the function pnorm().

```{r}

1 - pnorm(q = 600, mean = dairy_queen_mean, sd = dairy_queen_sd)

```
# To calculate the probability empirically, we simply need to determine how many observations fall 
# above 600 then divide this number by the total sample size.

```{r}
dairy_queen %>% 
  filter(cal_fat > 600) %>%
  summarise(percent = n() / nrow(dairy_queen))

```
# Exercise 6: Write out two probability questions that you would like to answer about any of the restaurants in this 
# dataset. Calculate those probabilities using both the theoretical normal distribution as well as the 
# empirical distribution (four probabilities in all). Which one had a closer agreement between the two methods?

```{r}
#Arby's >30gs protein calculations: 
arbys <- fastfood %>%
  filter(restaurant == "Arbys")

arbys_mean <- mean(arbys$protein)
arbys_sd <- sd(arbys$protein)

1 - pnorm(q = 30, mean = arbys_mean, sd = arbys_sd)

arbys %>% 
  filter(protein > 30) %>%
  summarise(percent = n() / nrow(arbys))

```
Exercise 7: Now let’s consider some of the other variables in the dataset. Out of all the different restaurants, 
which ones’ distribution is the closest to normal for sodium?

Based on the plots below, Burger King and Chick Fil-A had the distributions closest to normal for sodium.
```{r}
#Arbys sodium plot
arbys <- fastfood %>%
  filter(restaurant == "Arbys")

qqnorm(arbys$sodium, main = "Arbys")

```

```{r}
#Burger King sodium plot
bk <- fastfood %>%
  filter(restaurant == "Burger King")

qqnorm(bk$sodium, main = "Burger King")

```

```{r}
#Chick Fil-A sodium plot **
chick_fil_a <- fastfood %>%
  filter(restaurant == "Chick Fil-A")

qqnorm(chick_fil_a$sodium, main = "Chick Fil-A")
```
# Exercise 8:Note that some of the normal probability plots for sodium distributions seem to have a stepwise pattern. 
why do you think this might be the case?

# The stepwise pattern may emerge with these distributions for sodium across a number of fast food chains because 
# these restaurants typically offer an array of products (ie. french fries, soft drinks, sandwiches, salads) and the sodium content across these 
# different food groups can vary quite a bit (ie. high in french fries or fried food and low in salads –> thus leading to different 
# levels within the distribution.)

```{r}
#Subway sodium plot
sw <- fastfood %>%
  filter(restaurant == "Subway")

qqnorm(sw$sodium, main = "Subway")
```

```{r}
#Taco Bell sodium plot
taco_bell <- fastfood %>%
  filter(restaurant == "Taco Bell")

qqnorm(taco_bell$sodium, main = "Taco Bell")
```

# Exercise 9: As you can see, normal probability plots can be used both to assess normality and visualize skewness. 
# Make a normal probability plot for the total carbohydrates from a restaurant of your choice. 
# Based on this normal probability plot, is this variable left skewed, symmetric, or right skewed? 
# Use a histogram to confirm your findings.

# Based on the normal probability plot (below), this variable (total carbohydrates) is right skewed 
and the histogram confirms this with data being concentrated on the left with a tail running to the right.

```{r}
#Normal plot for total carbohydrates from Dairy Queen
qqnorm(fastfood$total_carb, main = "Dairy Queen Carbs")
qqline(fastfood$total_carb)
```

```{r}
summary(fastfood$total_carb)
hist(fastfood$total_carb)
```


